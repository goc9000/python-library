"""
Module dedicated to enums and flags describing access rights for all kinds of securables.
"""

from enum import IntFlag


class NTSpecificRights(IntFlag):
    """
    The 'specific rights' part of an NT access mask. This particular data type unifies rights for all possible kinds of
    securables, and is used in data structures that do not explicitly identify the type of securable involved, such as
    Access Control Entries.

    Most of the constants here coincide with the ones used in the Win32 API, except for the DIR_ and PIPE_ ones which
    have been added to further distinguish files from directories and pipes.
    """

    # Files
    FILE_READ_DATA = 0x0001
    FILE_WRITE_DATA = 0x0002
    FILE_APPEND_DATA = 0x0004
    FILE_READ_PROPERTIES = 0x0008
    FILE_WRITE_PROPERTIES = 0x0010
    FILE_EXECUTE = 0x0020
    FILE_READ_ATTRIBUTES = 0x0080
    FILE_WRITE_ATTRIBUTES = 0x0100

    # Directories
    DIR_LIST_DIRECTORY = 0x0001
    DIR_ADD_FILE = 0x0002
    DIR_ADD_SUBDIRECTORY = 0x0004
    DIR_READ_PROPERTIES = 0x0008
    DIR_WRITE_PROPERTIES = 0x0010
    DIR_TRAVERSE = 0x0020
    DIR_DELETE_CHILD = 0x0040
    DIR_READ_ATTRIBUTES = 0x0080
    DIR_WRITE_ATTRIBUTES = 0x0100

    # Pipes
    PIPE_READ_DATA = 0x0001
    PIPE_WRITE_DATA = 0x0002
    PIPE_CREATE_PIPE_INSTANCE = 0x0004

    # Active Directory objects
    DS_CREATE_CHILD = 0x0001
    DS_DELETE_CHILD = 0x0002
    DS_LIST = 0x0004
    DS_SELF = 0x0008
    DS_READ_PROP = 0x0010
    DS_WRITE_PROP = 0x0020
    DS_DELETE_TREE = 0x0040
    DS_LIST_OBJECT = 0x0080
    DS_CONTROL_ACCESS = 0x0100

    # Processes
    PROCESS_TERMINATE = 0x0001
    PROCESS_CREATE_THREAD = 0x0002
    PROCESS_VM_OPERATION = 0x0008
    PROCESS_VM_READ = 0x0010
    PROCESS_VM_WRITE = 0x0020
    PROCESS_DUP_HANDLE = 0x0040
    PROCESS_CREATE_PROCESS = 0x0080
    PROCESS_SET_QUOTA = 0x0100
    PROCESS_SET_INFORMATION = 0x0200
    PROCESS_QUERY_INFORMATION = 0x0400
    PROCESS_SUSPEND_RESUME = 0x0800
    PROCESS_QUERY_LIMITED_INFORMATION = 0x1000

    # Threads
    THREAD_TERMINATE = 0x0001
    THREAD_SUSPEND_RESUME = 0x0002
    THREAD_GET_CONTEXT = 0x0008
    THREAD_SET_CONTEXT = 0x0010
    THREAD_SET_INFORMATION = 0x0020
    THREAD_QUERY_INFORMATION = 0x0040
    THREAD_SET_THREAD_TOKEN = 0x0080
    THREAD_IMPERSONATE = 0x0100
    THREAD_DIRECT_IMPERSONATION = 0x0200
    THREAD_SET_LIMITED_INFORMATION = 0x0400
    THREAD_QUERY_LIMITED_INFORMATION = 0x0800

    # File mapping objects
    FILE_MAP_COPY = 0x0001
    FILE_MAP_WRITE = 0x0002
    FILE_MAP_READ = 0x0004
    FILE_MAP_EXECUTE = 0x0020

    # Access tokens
    TOKEN_ASSIGN_PRIMARY = 0x0001
    TOKEN_DUPLICATE = 0x0002
    TOKEN_IMPERSONATE = 0x0004
    TOKEN_QUERY = 0x0008
    TOKEN_QUERY_SOURCE = 0x0010
    TOKEN_ADJUST_PRIVILEGES = 0x0020
    TOKEN_ADJUST_GROUPS = 0x0040
    TOKEN_ADJUST_DEFAULT = 0x0080
    TOKEN_ADJUST_SESSION_ID = 0x0100

    # Window stations
    WINSTA_ENUM_DESKTOPS = 0x0001
    WINSTA_READ_ATTRIBUTES = 0x0002
    WINSTA_ACCESS_CLIPBOARD = 0x0004
    WINSTA_CREATE_DESKTOP = 0x0008
    WINSTA_WRITE_ATTRIBUTES = 0x0010
    WINSTA_ACCESS_GLOBAL_ATOMS = 0x0020
    WINSTA_EXIT_WINDOWS = 0x0040
    WINSTA_ENUMERATE = 0x0100
    WINSTA_READ_SCREEN = 0x0200

    # Desktops
    DESKTOP_READ_OBJECTS = 0x0001
    DESKTOP_CREATE_WINDOW = 0x0002
    DESKTOP_CREATE_MENU = 0x0004
    DESKTOP_HOOK_CONTROL = 0x0008
    DESKTOP_JOURNAL_RECORD = 0x0010
    DESKTOP_JOURNAL_PLAYBACK = 0x0020
    DESKTOP_ENUMERATE = 0x0040
    DESKTOP_WRITE_OBJECTS = 0x0080
    DESKTOP_SWITCH_DESKTOP = 0x0100

    # Registry keys
    KEY_QUERY_VALUE = 0x0001
    KEY_SET_VALUE = 0x0002
    KEY_CREATE_SUB_KEY = 0x0004
    KEY_ENUMERATE_SUB_KEYS = 0x0008
    KEY_NOTIFY = 0x0010
    KEY_CREATE_LINK = 0x0020

    # Services
    SERVICE_QUERY_CONFIG = 0x0001
    SERVICE_CHANGE_CONFIG = 0x0002
    SERVICE_QUERY_STATUS = 0x0004
    SERVICE_ENUMERATE_DEPENDENTS = 0x0008
    SERVICE_START = 0x0010
    SERVICE_STOP = 0x0020
    SERVICE_PAUSE_CONTINUE = 0x0040
    SERVICE_INTERROGATE = 0x0080
    SERVICE_USER_DEFINED_CONTROL = 0x0100

    # Service Control Manager
    SC_MANAGER_CONNECT = 0x0001
    SC_MANAGER_CREATE_SERVICE = 0x0002
    SC_MANAGER_ENUMERATE_SERVICE = 0x0004
    SC_MANAGER_LOCK = 0x0008
    SC_MANAGER_QUERY_LOCK_STATUS = 0x0010
    SC_MANAGER_MODIFY_BOOT_CONFIG = 0x0020

    # IPCs: Event
    EVENT_QUERY_STATE = 0x0001
    EVENT_MODIFY_STATE = 0x0002

    # IPCs: Mutex
    MUTEX_MODIFY_STATE = 0x0001

    # IPCs: Semaphore
    SEMAPHORE_QUERY_STATE = 0x0001
    SEMAPHORE_MODIFY_STATE = 0x0002

    # IPCs: Timer
    TIMER_QUERY_STATE = 0x0001
    TIMER_MODIFY_STATE = 0x0002

    # Job objects
    JOB_OBJECT_ASSIGN_PROCESS = 0x0001
    JOB_OBJECT_SET_ATTRIBUTES = 0x0002
    JOB_OBJECT_QUERY = 0x0004
    JOB_OBJECT_TERMINATE = 0x0008
    JOB_OBJECT_SET_SECURITY_ATTRIBUTES = 0x0010


class NTFileRights(IntFlag):
    READ_DATA = 0x0001
    WRITE_DATA = 0x0002
    APPEND_DATA = 0x0004
    READ_PROPERTIES = 0x0008
    WRITE_PROPERTIES = 0x0010
    EXECUTE = 0x0020
    READ_ATTRIBUTES = 0x0080
    WRITE_ATTRIBUTES = 0x0100


class NTDirectoryRights(IntFlag):
    LIST_DIRECTORY = 0x0001
    ADD_FILE = 0x0002
    ADD_SUBDIRECTORY = 0x0004
    READ_PROPERTIES = 0x0008
    WRITE_PROPERTIES = 0x0010
    TRAVERSE = 0x0020
    DELETE_CHILD = 0x0040
    READ_ATTRIBUTES = 0x0080
    WRITE_ATTRIBUTES = 0x0100


class NTPipeRights(IntFlag):
    READ_DATA = 0x0001
    WRITE_DATA = 0x0002
    CREATE_PIPE_INSTANCE = 0x0004


class NTRights(IntFlag):
    CREATE_CHILD = 0x0001
    DELETE_CHILD = 0x0002
    LIST = 0x0004
    SELF = 0x0008
    READ_PROP = 0x0010
    WRITE_PROP = 0x0020
    DELETE_TREE = 0x0040
    LIST_OBJECT = 0x0080
    CONTROL_ACCESS = 0x0100


class NTProcessRights(IntFlag):
    TERMINATE = 0x0001
    CREATE_THREAD = 0x0002
    VM_OPERATION = 0x0008
    VM_READ = 0x0010
    VM_WRITE = 0x0020
    DUP_HANDLE = 0x0040
    CREATE_PROCESS = 0x0080
    SET_QUOTA = 0x0100
    SET_INFORMATION = 0x0200
    QUERY_INFORMATION = 0x0400
    SUSPEND_RESUME = 0x0800
    QUERY_LIMITED_INFORMATION = 0x1000


class NTThreadRights(IntFlag):
    TERMINATE = 0x0001
    SUSPEND_RESUME = 0x0002
    GET_CONTEXT = 0x0008
    SET_CONTEXT = 0x0010
    SET_INFORMATION = 0x0020
    QUERY_INFORMATION = 0x0040
    SET_THREAD_TOKEN = 0x0080
    IMPERSONATE = 0x0100
    DIRECT_IMPERSONATION = 0x0200
    SET_LIMITED_INFORMATION = 0x0400
    QUERY_LIMITED_INFORMATION = 0x0800


class NTAccessTokenRights(IntFlag):
    ASSIGN_PRIMARY = 0x0001
    DUPLICATE = 0x0002
    IMPERSONATE = 0x0004
    QUERY = 0x0008
    QUERY_SOURCE = 0x0010
    ADJUST_PRIVILEGES = 0x0020
    ADJUST_GROUPS = 0x0040
    ADJUST_DEFAULT = 0x0080
    ADJUST_SESSION_ID = 0x0100


class NTFileMapRights(IntFlag):
    COPY = 0x0001
    WRITE = 0x0002
    READ = 0x0004
    EXECUTE = 0x0020


class NTWindowStationRights(IntFlag):
    ENUM_DESKTOPS = 0x0001
    READ_ATTRIBUTES = 0x0002
    ACCESS_CLIPBOARD = 0x0004
    CREATE_DESKTOP = 0x0008
    WRITE_ATTRIBUTES = 0x0010
    ACCESS_GLOBAL_ATOMS = 0x0020
    EXIT_WINDOWS = 0x0040
    ENUMERATE = 0x0100
    READ_SCREEN = 0x0200


class NTDesktopRights(IntFlag):
    READ_OBJECTS = 0x0001
    CREATE_WINDOW = 0x0002
    CREATE_MENU = 0x0004
    HOOK_CONTROL = 0x0008
    JOURNAL_RECORD = 0x0010
    JOURNAL_PLAYBACK = 0x0020
    ENUMERATE = 0x0040
    WRITE_OBJECTS = 0x0080
    SWITCH_DESKTOP = 0x0100


class NTRegistryKeyRights(IntFlag):
    QUERY_VALUE = 0x0001
    SET_VALUE = 0x0002
    CREATE_SUB_KEY = 0x0004
    ENUMERATE_SUB_KEYS = 0x0008
    NOTIFY = 0x0010
    CREATE_LINK = 0x0020


class NTServiceRights(IntFlag):
    QUERY_CONFIG = 0x0001
    CHANGE_CONFIG = 0x0002
    QUERY_STATUS = 0x0004
    ENUMERATE_DEPENDENTS = 0x0008
    START = 0x0010
    STOP = 0x0020
    PAUSE_CONTINUE = 0x0040
    INTERROGATE = 0x0080
    USER_DEFINED_CONTROL = 0x0100


class NTServiceControlManagerRights(IntFlag):
    CONNECT = 0x0001
    CREATE_SERVICE = 0x0002
    ENUMERATE_SERVICE = 0x0004
    LOCK = 0x0008
    QUERY_LOCK_STATUS = 0x0010
    MODIFY_BOOT_CONFIG = 0x0020


class NTEventRights(IntFlag):
    QUERY_STATE = 0x0001
    MODIFY_STATE = 0x0002


class NTMutexRights(IntFlag):
    MODIFY_STATE = 0x0001


class NTSemaphoreRights(IntFlag):
    QUERY_STATE = 0x0001
    MODIFY_STATE = 0x0002


class NTTimerRights(IntFlag):
    QUERY_STATE = 0x0001
    MODIFY_STATE = 0x0002


class NTJobRights(IntFlag):
    ASSIGN_PROCESS = 0x0001
    SET_ATTRIBUTES = 0x0002
    QUERY = 0x0004
    TERMINATE = 0x0008
    SET_SECURITY_ATTRIBUTES = 0x0010
